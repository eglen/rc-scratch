<html>
  <body>
    <input type="range" id="channel1" name="channel1" min="-50" max="50">
    <label for="channel1">Channel 1</label>
    <div id="outputdiv"></div>
  </body>
  <script>
    var output = document.getElementById("outputdiv");
var btn = document.getElementById("connectbtn");
var socket = false;

var updown = 0;
var leftright = 0;
var channel1 = 0;

console.log('test');
console.log(document.getElementById('channel1'));
onRangeChange(document.getElementById('channel1'), handleChannel1);
finishRequest();

function sendToFlask()
{
    const xhr = new XMLHttpRequest();
    const data = new FormData();

    data.append("updown", channel1);
    data.append("leftright", leftright);

    xhr.open("POST", "moveservos");
    xhr.send(data);
    output.innerHTML= "Channel 1: " + channel1 + "<br>Channel 2: " + leftright;
}

function handleRotation(event)
{
    updown = Math.round(event.gamma);
    leftright = Math.round(event.beta);
}

function handleChannel1(event) {
	console.log(event.target.value);
	channel1 = event.target.value;
}

//https://stackoverflow.com/questions/18544890/onchange-event-on-input-type-range-is-not-triggering-in-firefox-while-dragging
function onRangeChange(r,f) {
  var n,c,m;
  r.addEventListener("input",function(e){n=1;c=e.target.value;if(c!=m)f(e);m=c;});
  r.addEventListener("change",function(e){if(!n)f(e);});
}

function finishRequest()
{
    setInterval(sendToFlask, 250);
}

  </script>
</html>

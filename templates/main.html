<html>
  <head>
    <style>
      input[type=range][orient=vertical] {
        writing-mode: bt-lr; /* IE */
        -webkit-appearance: slider-vertical; /* WebKit */
        width: 30px;
        height: 300px;
        padding: 0 5px;
      }

      input[type=range] {
        width: 800px;
        height: 30px;
      }

      #video {
        background-color:#999999;
        width:800px;
        height:300px;
        float: left;
      }
    </style>
  </head>
  <body>
    <img id="video" src="{{ url_for('video_feed') }}">

    <input type="range" id="throttle" name="throttle" min="-50" max="50" orient="vertical">
    <input type="range" id="rudder" name="rudder" min="-50" max="50">

  </body>
  <script>
    var rudder = 0;
    var throttle = 0;

    onRangeChange(document.getElementById('rudder'), handleRudder);
    onRangeChange(document.getElementById('throttle'), handleThrottle);

    function sendToFlask()
    {
        const xhr = new XMLHttpRequest();
        const data = new FormData();

        data.append("rudder", rudder);
        data.append("throttle", throttle);

        xhr.open("POST", "moveservos");
        xhr.send(data);
    }

    function handleRudder(event) {
      rudder = event.target.value;
      sendToFlask();
    }

    function handleThrottle(event) {
      throttle = event.target.value;
      sendToFlask()
    }

    //https://stackoverflow.com/questions/18544890/onchange-event-on-input-type-range-is-not-triggering-in-firefox-while-dragging
    function onRangeChange(r,f) {
      var n,c,m;
      r.addEventListener("input",function(e){n=1;c=e.target.value;if(c!=m)f(e);m=c;});
      r.addEventListener("change",function(e){if(!n)f(e);});
    }
  </script>
</html>
